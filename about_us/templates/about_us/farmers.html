{% extends 'blogs/base.html' %}
{% load static %}
{% block content %}
<style>
  /* Farmers Section Styles */
  .farmers-section {
    background: #f7f7f7;
    padding: 50px;
  }

  .farmers-section .section-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .farmers-section .section-header h2 {
    color: #33691e;
    font-size: 2.2rem;
    margin-bottom: 10px;
  }

  .farmers-section .section-header p {
    color: #6d4c41;
    font-size: 1.1rem;
  }

  .farmers-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 40px;
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .farmer-card {
    background: transparent;
    border-radius: 0;
    overflow: visible;
    box-shadow: none;
    transition: all 0.3s ease;
    position: relative;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .farmer-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: white;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    color: #689F38;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    z-index: 1;
  }

  .farmer-img {
    height: 300px;
    width: 90%;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 8px;
    margin-bottom: -20px;
    position: relative;
    z-index: 0;
  }

  .farmer-info {
    background: white;
    width: 90%;
    padding: 30px 20px 20px;
    border-radius: 0 0 8px 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    position: relative;
    z-index: 0;
    margin-top: 0;
  }

  .farmer-info h3 {
    color: #3e4e30;
    margin-bottom: 8px;
    font-size: 1.3rem;
    text-align: center;
  }

  .specialty {
    color: #689F38;
    font-weight: 600;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-align: center;
  }

  .farmer-footer {
    border-top: 1px solid #f0f0f0;
    padding-top: 15px;
    margin-top: 15px;
    text-align: center;
  }

  .click-me {
    color: #d97706;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-block;
  }

  .farmer-card:hover .farmer-img {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.2);
  }

  .farmer-card:hover .click-me {
    color: #b45309;
    transform: translateX(5px);
  }

  /* Farmer Modal Styles */
  .farmer-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    overflow: auto;
    padding: 20px;
  }

  .farmer-modal-content {
    background: transparent;
    max-width: 900px;
    width: 90%;
    border-radius: 12px;
    position: relative;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  }

  .farmer-modal-close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 2rem;
    color: #fff;
    cursor: pointer;
    z-index: 1001;
    transition: color 0.3s ease;
  }

  .farmer-modal-close:hover {
    color: #689F38;
  }

  .farmer-modal-inner {
    display: flex;
    flex-direction: row;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    overflow: hidden;
  }

  .farmer-modal-image {
    flex: 1;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    min-height: 400px;
    border-radius: 12px 0 0 12px;
  }

  .farmer-modal-text {
    flex: 1;
    padding: 30px;
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background: rgba(0, 0, 0, 0.5);
  }

  .farmer-modal-text h2 {
    color: #fff;
    font-size: 2rem;
    margin-bottom: 10px;
  }

  .modal-specialty {
    color: #689F38;
    font-weight: 600;
    font-size: 1.2rem;
    margin-bottom: 10px;
  }

  .modal-badge {
    display: inline-block;
    background: #689F38;
    color: #fff;
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 15px;
  }

  .farmer-modal-text p {
    font-size: 1.1rem;
    line-height: 1.6;
    color: #ddd;
  }

  /* Updated Stack Carousel */
  .carousel-section {
    width: 90%;
    max-width: 1200px;
    margin: 100px auto;
    padding: 40px 0;
  }

  .carousel-container {
    display: grid;
    grid-template-columns: 50px 1fr 550px 50px;
    align-items: start;
    gap: 30px;
  }

  .cards-wrapper {
    position: relative;
    height: 400px;
    perspective: 1000px;
  }

  .card {
    position: absolute;
    width: 300px;
    height: 385px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    padding: 15px;
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .card:nth-child(1) { z-index: 4; transform: rotate(-3deg); }
  .card:nth-child(2) { z-index: 3; transform: translateX(15%) rotate(2deg); }
  .card:nth-child(3) { z-index: 2; transform: translateX(30%) rotate(-1deg); }
  .card:nth-child(n+4) { z-index: 1; transform: translateX(45%) rotate(0deg); }

  .card.active {
    transform: translateX(0%) rotate(0deg) scale(1.05);
    z-index: 5;
  }

  .card-image {
    width: 100%;
    height: 300px;
    border-radius: 15px;
    object-fit: cover;
    margin-bottom: 15px;
    transition: transform 0.3s;
  }

  .nav-arrow {
    font-size: 2em;
    color: #7cb342;
    cursor: pointer;
    transition: transform 0.3s;
    padding: 10px;
    align-self: center;
  }

  .content-display {
    padding: 25px;
    background: #f8fdf1;
    border-radius: 20px;
    height: 350px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.05);
    border-left: 5px solid #7cb342;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
  }

  .carousel-title {
    text-align: center;
    color: rgb(28, 120, 63);
    font-size: 3em;
    font-weight: bold;
    font-family: 'Georgia', serif;
    margin-bottom: 50px;
  }

  .content-title {
    color: #33691e;
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 15px;
    font-family: 'Georgia', serif;
  }

  .content-text {
    color: #6d4c41;
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 10px;
  }

  .content-tags {
    color: #689F38;
    font-weight: 600;
    font-size: 0.9rem;
  }

  /* Photo Album Iframe Container */
  .photo-album-iframe-container {
    margin: 0;
    width: 100%;
    padding: 50px 0 20px 0; /* Reduced bottom padding to minimize space below iframe */
    box-sizing: border-box;
    background: #f7f7f7;
  }

  .photo-album-iframe {
    width: 100%;
    height: 772px; /* Updated to match new content height: 600px (book) + 40px (book margins) + 48px (controls) + 24px (controls margin) + 40px (container padding) + 20px (book-wrapper margin-bottom) */
    max-width: none;
    border: none;
    display: block;
    overflow: hidden;
  }

  /* Responsive Adjustments */
  @media (max-width: 768px) {
    .farmers-grid {
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }

    .farmer-modal-inner {
      flex-direction: column;
    }

    .farmer-modal-image {
      min-height: 300px;
      border-radius: 12px 12px 0 0;
    }

    .farmer-modal-text {
      border-radius: 0 0 12px 12px;
    }

    .photo-album-iframe {
      height: 620px; /* Adjusted for smaller content height on tablets */
    }
  }

  @media (max-width: 480px) {
    .farmers-grid {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .farmer-modal-text {
      padding: 20px;
    }

    .farmer-modal-text h2 {
      font-size: 1.5rem;
    }

    .modal-specialty {
      font-size: 1rem;
    }

    .farmer-modal-text p {
      font-size: 1rem;
    }

    .photo-album-iframe {
      height: 520px; /* Adjusted for smaller content height on mobile */
    }
  }
</style>

<div class="carousel-section">
  <h2 class="carousel-title">From Soil to Soul</h2>
  
  <div class="carousel-container">
    <div class="nav-arrow left-arrow">‚ùÆ</div>
    
    <div class="cards-wrapper">
      <div class="card active" data-content="<h3 class='content-title'>Feel the Farm Spirit!</h3><p class='content-text'>Bask in the sunlit bustle of the market, where the air hums with laughter and the scent of fresh earth. Connect with growers sharing their harvest‚Äôs heart‚Äîevery Saturday, it‚Äôs a celebration of community! üåæ <br><span class='content-tags'>#MarketVibes #CommunityLove</span></p>">
        <img class="card-image" src="{% static 'images/f.jpg' %}" alt="Card 1 Image">
      </div>
      <div class="card" data-content="<h3 class='content-title'>Embrace Nature‚Äôs Rhythm!</h3><p class='content-text'>Step into a world where soil whispers stories‚Äîwatch hands craft jams, taste the sun in every bite, and feel the pulse of sustainable living. Join the harmony every week! üå± <br><span class='content-tags'>#EarthyJoy #SustainableSoul</span></p>">
        <img class="card-image" src="{% static 'images/f2.jpg' %}" alt="Card 2 Image">
      </div>
      <div class="card" data-content="<h3 class='content-title'>Savor the Local Beat!</h3><p class='content-text'>Lose yourself in the colorful chaos of fresh picks‚Äîorchard apples, vibrant greens, and egg-yolk golds‚Äîwhere every stall sings of tradition and togetherness. Come feel the vibe! üçé <br><span class='content-tags'>#LocalRhythm #FreshEnergy</span></p>">
        <img class="card-image" src="{% static 'images/f3.jpg' %}" alt="Card 3 Image">
      </div>
    </div>
    
    <div class="content-display" id="card-content"></div>
    <div class="nav-arrow right-arrow">‚ùØ</div>
  </div>
</div>

<!-- Farmers Showcase Section -->
<div class="farmers-section">
  <div class="container">
    <div class="section-header">
      <h2>üå± Our Dedicated Farmers</h2>
      <p>Meet the passionate growers who bring fresh, local produce to your table</p>
    </div>
    
    <div class="farmers-grid">
      <!-- Farmer 1 -->
      <div class="farmer-card" onclick="openFarmerModal('Maria Rodriguez', 'Organic Vegetables', 'ü•ï', 'Maria has been growing organic vegetables for 15 years using sustainable methods passed down through generations. Her heirloom tomatoes are a market favorite!', '{% get_static_prefix %}images/farmer1.jpg', 'Certified Organic')">
        <div class="farmer-badge">Certified Organic</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/farmer1.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Maria Rodriguez</h3>
          <p class="specialty">ü•ï Organic Vegetables</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Maria ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 2 -->
      <div class="farmer-card" onclick="openFarmerModal('John Peterson', 'Apple Orchard', 'üçé', 'John\'s family has tended this orchard for over 50 years. He grows 12 varieties of apples using integrated pest management.', '{% get_static_prefix %}images/farmer2.jpg', '3rd Generation')">
        <div class="farmer-badge">3rd Generation</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/farmer2.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>John Peterson</h3>
          <p class="specialty">üçé Apple Orchard</p>
          <div class="farmer-footer">
            <span class="click-me">Meet John ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 3 -->
      <div class="farmer-card" onclick="openFarmerModal('The Nguyen Family', 'Asian Greens', 'ü•¨', 'The Nguyen family specializes in traditional Asian vegetables rarely found in supermarkets. Their bok choy and Thai basil are customer favorites.', '{% get_static_prefix %}images/farmer3.jpg', 'Family Farm')">
        <div class="farmer-badge">Family Farm</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/farmer3.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>The Nguyen Family</h3>
          <p class="specialty">ü•¨ Asian Greens</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Them ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 4 -->
      <div class="farmer-card" onclick="openFarmerModal('Sarah & Tom Wilkins', 'Free-Range Eggs', 'ü•ö', 'This couple raises happy chickens on pasture. Their eggs have deep orange yolks and are collected fresh each morning.', '{% get_static_prefix %}images/farmer4.jpg', 'Pasture Raised')">
        <div class="farmer-badge">Pasture Raised</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/farmer4.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Sarah & Tom Wilkins</h3>
          <p class="specialty">ü•ö Free-Range Eggs</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Them ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 5 -->
      <div class="farmer-card" onclick="openFarmerModal('Lila Nguyen', 'Asian Greens', 'ü•¨', 'Lila Nguyen grows a variety of Asian greens, including bok choy, tatsoi, and mustard greens, using eco-friendly methods to ensure vibrant flavors.', '{% get_static_prefix %}images/f5.jpg', 'Family Farm')">
        <div class="farmer-badge">Family Farm</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/f5.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Lila Nguyen</h3>
          <p class="specialty">ü•¨ Asian Greens</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Lila ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 6 -->
      <div class="farmer-card" onclick="openFarmerModal('Anh Nguyen', 'Asian Greens', 'ü•¨', 'Anh Nguyen brings expertise in cultivating rare Asian greens, including gai lan and mizuna, a staple at local restaurants seeking authentic flavors.', '{% get_static_prefix %}images/f6.jpg', 'Family Farm')">
        <div class="farmer-badge">Family Farm</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/f6.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Anh Nguyen</h3>
          <p class="specialty">ü•¨ Asian Greens</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Anh ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 7 -->
      <div class="farmer-card" onclick="openFarmerModal('Mai Nguyen', 'Asian Greens', 'ü•¨', 'Mai Nguyen focuses on organic Asian herbs like Thai basil and shiso, grown with care to preserve their aromatic qualities, a favorite for home cooks.', '{% get_static_prefix %}images/f7.jpg', 'Family Farm')">
        <div class="farmer-badge">Family Farm</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/f7.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Mai Nguyen</h3>
          <p class="specialty">ü•¨ Asian Greens</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Mai ‚Üí</span>
          </div>
        </div>
      </div>
      
      <!-- Farmer 8 -->
      <div class="farmer-card" onclick="openFarmerModal('Tuan Nguyen', 'Asian Greens', 'ü•¨', 'Tuan Nguyen cultivates specialty greens like daikon sprouts and pea shoots, known for their freshness and quality at the market.', '{% get_static_prefix %}images/f8.jpg', 'Family Farm')">
        <div class="farmer-badge">Family Farm</div>
        <div class="farmer-img" style="background-image: url('{% static 'images/f8.jpg' %}')"></div>
        <div class="farmer-info">
          <h3>Tuan Nguyen</h3>
          <p class="specialty">ü•¨ Asian Greens</p>
          <div class="farmer-footer">
            <span class="click-me">Meet Tuan ‚Üí</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Farmer Modal -->
<div id="farmerModal" class="farmer-modal">
  <div class="farmer-modal-content">
    <span class="farmer-modal-close">√ó</span>
    <div class="farmer-modal-inner">
      <div class="farmer-modal-image" id="modalImage"></div>
      <div class="farmer-modal-text">
        <h2 id="modalName"></h2>
        <p class="modal-specialty" id="modalRole"></p>
        <p class="modal-badge" id="modalBadge"></p>
        <p id="modalBio"></p>
      </div>
    </div>
  </div>
</div>

<!-- Photo Album Iframe -->
<div class="photo-album-iframe-container">
  <iframe src="/about-us/teambook/" class="photo-album-iframe" title="Interactive Photo Album"></iframe>
</div>

<script>
  // Carousel Script
  document.addEventListener('DOMContentLoaded', () => {
    const cards = Array.from(document.querySelectorAll('.card'));
    const contentDisplay = document.getElementById('card-content');
    const leftArrow = document.querySelector('.left-arrow');
    const rightArrow = document.querySelector('.right-arrow');
    
    function rotateStack(direction) {
      const activeCard = cards.find(card => card.classList.contains('active'));
      
      if(direction === 'next') {
        cards.push(cards.shift());
      } else {
        cards.unshift(cards.pop());
      }
      
      cards.forEach((card, index) => {
        card.classList.remove('active');
        card.style.zIndex = 4 - index;
        card.style.transform = `
          translateX(${index * 15}%)
          rotate(${index % 2 === 0 ? -3 : 3}deg)
        `;
        
        if(index === 0) {
          card.classList.add('active');
          card.style.transform = 'translateX(0%) rotate(0deg) scale(1.05)';
          card.style.zIndex = 5;
        }
      });
      
      contentDisplay.innerHTML = cards[0].dataset.content;
    }

    rightArrow.addEventListener('click', () => rotateStack('next'));
    leftArrow.addEventListener('click', () => rotateStack('prev'));
    
    contentDisplay.innerHTML = cards[0].dataset.content;
  });

  // Farmer Modal Script
  function openFarmerModal(name, specialty, emoji, bio, imageUrl, badge) {
    document.getElementById('modalName').textContent = name;
    document.getElementById('modalRole').textContent = `${emoji} ${specialty}`;
    document.getElementById('modalBadge').textContent = badge;
    document.getElementById('modalBio').textContent = bio;
    document.getElementById('modalImage').style.backgroundImage = `url(${imageUrl})`;
    document.getElementById('farmerModal').style.display = 'flex';
  }

  // Close modal when clicking the close button
  document.querySelector('.farmer-modal-close').addEventListener('click', () => {
    document.getElementById('farmerModal').style.display = 'none';
  });

  // Close modal when clicking outside the modal content
  document.getElementById('farmerModal').addEventListener('click', (e) => {
    if (e.target === document.getElementById('farmerModal')) {
      document.getElementById('farmerModal').style.display = 'none';
    }
  });

  // Close modal with Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && document.getElementById('farmerModal').style.display === 'flex') {
      document.getElementById('farmerModal').style.display = 'none';
    }
  });
</script>
{% endblock %}